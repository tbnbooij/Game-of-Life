<!DOCTYPE html>
<html>
  <head>
    <title>Game of Life</title>
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: black;
        height: 100vh;
      }
      #main_canvas {
        width: 600px;
        height: 600px;
        background-color: white;
        box-shadow: 0 0 20px white;
      }
    </style>
  </head>
  <body>
    <canvas id="main_canvas"></canvas>
  </body>
  <script>
    function mod(n, m) {
      return ((n % m) + m) % m;
    }
    const rel = [[0,1], [1,0], [1,1], [0,-1], [-1,0], [-1,1], [1,-1], [-1,-1]]
    let size = 75
    const canvas = document.getElementById("main_canvas")
    const ctx = canvas.getContext('2d');
    const tile_width = Math.round(canvas.width/size)
    const tile_height = Math.round(canvas.height/size)
    ctx.imageSmoothingEnabled = false
    let grid = []
    for(var i = 0; i < size; i++) {
      let row = []
      for(var j = 0; j < size; j++) {
        if(Math.random() > 0.6) {
          row.push(true)
        }
        else {
          row.push(false)
        }
      }
      grid.push(row)
    }
    printGrid(grid)
    function printGrid(g) {
      for(var i = 0; i < size; i++) {
        for(var j = 0; j < size; j++) {
          let x = i * tile_width, y = j * tile_height
          let r1 = Math.floor(Math.random()*256)
          if(g[i][j]) {
            ctx.fillStyle = 'hsla(' + r1 + ', 100%, 50%, 1)'
          }
          else {
            ctx.fillStyle = 'black'
          }
          ctx.fillRect(x, y, tile_width, tile_height)
        }
      }
    }
    function nextGen(g) {
      let newGrid = []
      for(var i = 0; i < size; i++) {
        let newRow = []
        for(var j = 0; j < size; j++) {
          let z = 0
          for(var k = 0; k < rel.length; k++) {
            if(g[mod(i+rel[k][0], size)][mod(j+rel[k][1], size)]) {
              z++
            }
          }
          if(g[i][j]) {
            if(z === 2 || z === 3) {
              newRow.push(true)
            }
            else {
              newRow.push(false)
            }
          }
          else {
            if(z === 3) {
              newRow.push(true)
            }
            else {
              newRow.push(false)
            }
          }
        }
        newGrid.push(newRow)
      }
      for(var i = 0; i < size; i++) {
        for(var j = 0; j < size; j++) {
          grid[i][j] = newGrid[i][j]
        }
      }
      printGrid(newGrid)
      main()
    }
    function main() {
      setTimeout(function() {
        nextGen(grid)
      }, 50)
    }
    main()
    function reset() {
      grid = []
      for(var i = 0; i < size; i++) {
        let row = []
        for(var j = 0; j < size; j++) {
          if(Math.random() > 0.6) {
            row.push(true)
          }
          else {
            row.push(false)
          }
        }
        grid.push(row)
      }
    }
  </script>
</html>
